{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tanmaymoharana/Documents/projects/industrial/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(loginUser),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(logoutUser),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(watchUserLogin),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(watchUserLogout),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(loginSaga);import{takeEvery,fork,put,all,call}from'redux-saga/effects';// Login Redux States\nimport{CHECK_LOGIN,LOGOUT_USER}from'./actionTypes';import{apiError,loginUserSuccessful,logoutUserSuccess}from'./actions';// AUTH related methods\nimport{postLogin}from'../../../helpers/fackBackend_Helper';import{getFirebaseBackend}from'../../../helpers/firebase_helper';//Initilize firebase\nvar fireBaseBackend=getFirebaseBackend();//If user is login then dispatch redux action's are directly from here.\nfunction loginUser(_ref){var _ref$payload,user,history,response,_response;return _regeneratorRuntime.wrap(function loginUser$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref$payload=_ref.payload,user=_ref$payload.user,history=_ref$payload.history;_context.prev=1;if(!(process.env.REACT_APP_DEFAULTAUTH===\"firebase\")){_context.next=10;break;}_context.next=5;return call(fireBaseBackend.loginUser,user.username,user.password);case 5:response=_context.sent;_context.next=8;return put(loginUserSuccessful(response));case 8:_context.next=16;break;case 10:_context.next=12;return call(postLogin,'/post-login',{username:user.username,password:user.password});case 12:_response=_context.sent;localStorage.setItem(\"authUser\",JSON.stringify(_response));_context.next=16;return put(loginUserSuccessful(_response));case 16:history.push('/dashboard');_context.next=23;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](1);_context.next=23;return put(apiError(_context.t0));case 23:case\"end\":return _context.stop();}}},_marked,null,[[1,19]]);}function logoutUser(_ref2){var history,response;return _regeneratorRuntime.wrap(function logoutUser$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:history=_ref2.payload.history;_context2.prev=1;localStorage.removeItem(\"authUser\");if(!(process.env.REACT_APP_DEFAULTAUTH==='firebase')){_context2.next=9;break;}_context2.next=6;return call(fireBaseBackend.logout);case 6:response=_context2.sent;_context2.next=9;return put(logoutUserSuccess(response));case 9:history.push('/login');_context2.next=16;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](1);_context2.next=16;return put(apiError(_context2.t0));case 16:case\"end\":return _context2.stop();}}},_marked2,null,[[1,12]]);}export function watchUserLogin(){return _regeneratorRuntime.wrap(function watchUserLogin$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return takeEvery(CHECK_LOGIN,loginUser);case 2:case\"end\":return _context3.stop();}}},_marked3);}export function watchUserLogout(){return _regeneratorRuntime.wrap(function watchUserLogout$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeEvery(LOGOUT_USER,logoutUser);case 2:case\"end\":return _context4.stop();}}},_marked4);}function loginSaga(){return _regeneratorRuntime.wrap(function loginSaga$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return all([fork(watchUserLogin),fork(watchUserLogout)]);case 2:case\"end\":return _context5.stop();}}},_marked5);}export default loginSaga;","map":{"version":3,"sources":["/Users/tanmaymoharana/Documents/projects/industrial/dashboard/src/store/auth/login/saga.js"],"names":["loginUser","logoutUser","watchUserLogin","watchUserLogout","loginSaga","takeEvery","fork","put","all","call","CHECK_LOGIN","LOGOUT_USER","apiError","loginUserSuccessful","logoutUserSuccess","postLogin","getFirebaseBackend","fireBaseBackend","payload","user","history","process","env","REACT_APP_DEFAULTAUTH","username","password","response","localStorage","setItem","JSON","stringify","push","removeItem","logout"],"mappings":"6NAcUA,S,iDAiBAC,U,iDAeOC,c,iDAIAC,e,iDAIPC,S,EAtDV,OAASC,SAAT,CAAoBC,IAApB,CAA0BC,GAA1B,CAA+BC,GAA/B,CAAoCC,IAApC,KAAgD,oBAAhD,CAEA;AACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,eAAzC,CACA,OAASC,QAAT,CAAmBC,mBAAnB,CAAwCC,iBAAxC,KAAiE,WAAjE,CAEA;AACA,OAASC,SAAT,KAA0B,qCAA1B,CACA,OAASC,kBAAT,KAAmC,kCAAnC,CAEA;AACA,GAAMC,CAAAA,eAAe,CAAGD,kBAAkB,EAA1C,CAEA;AACA,QAAUhB,CAAAA,SAAV,4LAAsBkB,OAAtB,CAAiCC,IAAjC,cAAiCA,IAAjC,CAAuCC,OAAvC,cAAuCA,OAAvC,sBAEeC,OAAO,CAACC,GAAR,CAAYC,qBAAZ,GAAsC,UAFrD,2CAGiC,MAAMd,CAAAA,IAAI,CAACQ,eAAe,CAACjB,SAAjB,CAA4BmB,IAAI,CAACK,QAAjC,CAA2CL,IAAI,CAACM,QAAhD,CAAV,CAHjC,OAGsBC,QAHtB,+BAIgB,MAAMnB,CAAAA,GAAG,CAACM,mBAAmB,CAACa,QAAD,CAApB,CAAT,CAJhB,uDAOiC,MAAMjB,CAAAA,IAAI,CAACM,SAAD,CAAY,aAAZ,CAA2B,CAACS,QAAQ,CAAEL,IAAI,CAACK,QAAhB,CAA0BC,QAAQ,CAAEN,IAAI,CAACM,QAAzC,CAA3B,CAAV,CAPjC,QAOsBC,SAPtB,eAQgBC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAiCC,IAAI,CAACC,SAAL,CAAeJ,SAAf,CAAjC,EARhB,iBASgB,MAAMnB,CAAAA,GAAG,CAACM,mBAAmB,CAACa,SAAD,CAApB,CAAT,CAThB,QAWYN,OAAO,CAACW,IAAR,CAAa,YAAb,EAXZ,kGAaY,MAAMxB,CAAAA,GAAG,CAACK,QAAQ,aAAT,CAAT,CAbZ,qEAiBA,QAAUX,CAAAA,UAAV,mJAAkCmB,OAAlC,OAAuBF,OAAvB,CAAkCE,OAAlC,kBAEQO,YAAY,CAACK,UAAb,CAAwB,UAAxB,EAFR,KAIYX,OAAO,CAACC,GAAR,CAAYC,qBAAZ,GAAsC,UAJlD,4CAK6B,MAAMd,CAAAA,IAAI,CAACQ,eAAe,CAACgB,MAAjB,CAAV,CAL7B,OAKkBP,QALlB,iCAMY,MAAMnB,CAAAA,GAAG,CAACO,iBAAiB,CAACY,QAAD,CAAlB,CAAT,CANZ,OASQN,OAAO,CAACW,IAAR,CAAa,QAAb,EATR,uGAWQ,MAAMxB,CAAAA,GAAG,CAACK,QAAQ,cAAT,CAAT,CAXR,uEAeA,MAAO,SAAUV,CAAAA,cAAV,8IACH,MAAMG,CAAAA,SAAS,CAACK,WAAD,CAAcV,SAAd,CAAf,CADG,wDAIP,MAAO,SAAUG,CAAAA,eAAV,+IACH,MAAME,CAAAA,SAAS,CAACM,WAAD,CAAcV,UAAd,CAAf,CADG,wDAIP,QAAUG,CAAAA,SAAV,yIACI,MAAMI,CAAAA,GAAG,CAAC,CACNF,IAAI,CAACJ,cAAD,CADE,CAENI,IAAI,CAACH,eAAD,CAFE,CAAD,CAAT,CADJ,wDAOA,cAAeC,CAAAA,SAAf","sourcesContent":["import { takeEvery, fork, put, all, call } from 'redux-saga/effects';\r\n\r\n// Login Redux States\r\nimport { CHECK_LOGIN, LOGOUT_USER } from './actionTypes';\r\nimport { apiError, loginUserSuccessful, logoutUserSuccess } from './actions';\r\n\r\n// AUTH related methods\r\nimport { postLogin } from '../../../helpers/fackBackend_Helper';\r\nimport { getFirebaseBackend } from '../../../helpers/firebase_helper';\r\n\r\n//Initilize firebase\r\nconst fireBaseBackend = getFirebaseBackend();\r\n\r\n//If user is login then dispatch redux action's are directly from here.\r\nfunction* loginUser({ payload: { user, history } }) {\r\n        try {\r\n            if(process.env.REACT_APP_DEFAULTAUTH === \"firebase\") {\r\n                const response = yield call(fireBaseBackend.loginUser, user.username, user.password);\r\n                yield put(loginUserSuccessful(response));\r\n            }\r\n            else {\r\n                const response = yield call(postLogin, '/post-login', {username: user.username, password: user.password});\r\n                localStorage.setItem(\"authUser\", JSON.stringify(response));\r\n                yield put(loginUserSuccessful(response));\r\n            }\r\n            history.push('/dashboard');\r\n        } catch (error) {\r\n            yield put(apiError(error));\r\n        }\r\n}\r\n\r\nfunction* logoutUser({ payload: { history } }) {\r\n    try {\r\n        localStorage.removeItem(\"authUser\");\r\n\r\n        if (process.env.REACT_APP_DEFAULTAUTH === 'firebase') {\r\n            const response = yield call(fireBaseBackend.logout);\r\n            yield put(logoutUserSuccess(response));\r\n        }\r\n\r\n        history.push('/login');\r\n    } catch (error) {\r\n        yield put(apiError(error));\r\n    }\r\n}\r\n\r\nexport function* watchUserLogin() {\r\n    yield takeEvery(CHECK_LOGIN, loginUser)\r\n}\r\n\r\nexport function* watchUserLogout() {\r\n    yield takeEvery(LOGOUT_USER, logoutUser)\r\n}\r\n\r\nfunction* loginSaga() {\r\n    yield all([\r\n        fork(watchUserLogin),\r\n        fork(watchUserLogout),\r\n    ]);\r\n}\r\n\r\nexport default loginSaga;"]},"metadata":{},"sourceType":"module"}